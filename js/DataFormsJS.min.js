// @link https://www.dataformsjs.com
// @author Conrad Sollitt (http://www.conradsollitt.com)
// @license MIT
!function(){"use strict";var h={NotSet:"Not Set",Unknown:"Unknown",Mixed:"Mixed",Handlebars:"Handlebars",Vue:"Vue",Nunjucks:"Nunjucks",Underscore:"Underscore",Text:"Text"},c=h.NotSet,u=[h.Handlebars,h.Vue,h.Nunjucks,h.Underscore,h.Text],p=!1,s=!1,f=!1,g=null,m=0,t=null,v=!1,w=0,a=-1!==navigator.userAgent.indexOf("Trident/"),y=null;function i(e,t,r,o){if(typeof e!==t)throw console.log(e),new TypeError("["+r+"] was not defined as a "+t+" when the function "+o+" was called")}function o(e,t,r){if(void 0===e)throw new TypeError("["+t+"] must first be defined before the function "+r+" is called");if("object"!=typeof e)throw console.log(e),new TypeError("["+t+"] was not defined as an object when the function "+r+" was called")}function n(e,t,r){if(""===e)throw new TypeError("["+t+"] must have a value when defined when the function "+r+" is called")}function l(e,t,r){if(void 0!==e[r])throw console.log(e),new TypeError("["+t+"."+r+"] is already defined")}function d(e,t,r,o){for(var n=0,a=o.length;n<a;n++)if(void 0!==e[o[n]]&&"function"!=typeof e[o[n]])throw console.log(e),new TypeError(r+"["+t+"]."+o[n]+" is not defined as a function.")}function E(e,t,r,o){for(var n=0,a=o.length;n<a;n++)if(void 0!==e[o[n]]&&null!==e[o[n]])return;throw console.log(e),new TypeError(r+"["+t+"] must have one of the following properties defined: "+o.join(", "))}function C(e,t){var r="";try{if(null!==t&&t.path)r='Error with [Controller.path = "'+t.path+'"] - ';else if(null!==e&&e instanceof HTMLElement){var o=e.getAttribute("data-template-id"),n=e.getAttribute("data-template-url");o=null===o?"":' data-template-id="'+o+'"',n=null===n?"":' data-template-url="'+n+'"',r="Error with Element <"+e.tagName.toLowerCase(),r+=' id="'+e.id+'"',r+=' class="'+e.className+'"',r+=o+n+"> - "}return r}catch(e){return console.error(e),r}}function b(e,t,r){var o=document.createElement(e);return o.textContent=t,r&&(o.className=r),o}function T(t,r){console.error(t),window.setTimeout(function(){if(r&&null===r.parentNode){var e=document.querySelector("body");(e=e||document.documentElement).appendChild(r),R.activeTemplate&&(R.activeTemplate.error=!0,R.activeTemplate.errorMessage=t.toString())}R.showError(r,t)},500)}function S(e,t,r){var o,n,a=null,l=null,i=null,s=null,d=null;if(null===t)i=e.getAttribute("data-template-id"),s=e.getAttribute("data-template-url"),null!==R.activeController&&(d=R.activeController.viewEngine);else{if(i=t.viewId,s=t.viewUrl,void 0!==t.viewEngine&&(d=t.viewEngine),void 0===i&&(i=null),void 0===s&&(s=null),null!==i&&null!==s)return void r(A(null,i,s,d,!0,"A controller must have either [viewId] or [viewUrl] defined but not both properties. This error is not possible when calling the [addController()] so one or more of the properties were modified by JavaScript code after the controller was already added."));if(null===i&&null===s)return"function"==typeof t.onRouteLoad||"function"==typeof t.onBeforeRender||"function"==typeof t.onRendered?void r(null):void r(A(null,i,s,d,!0,"A controller must have either [viewId] or [viewUrl] defined but neither property is defined. This error is not possible when calling the [addController()] so one or more of the properties were modified by JavaScript code after the controller was already added."))}for(o=0,n=R.compiledTemplates.length;o<n;o++){if(null!==i&&R.compiledTemplates[o].id===i)return void r(R.compiledTemplates[o]);if(null!==s&&R.compiledTemplates[o].url===s)return void r(R.compiledTemplates[o])}if(null!==s)l=s,null===d&&(d=c);else{if(null===(a=document.getElementById(i)))return void r(A(e,i,s,d,!0,"Script Tag for Template ID ["+i+"] does not exist."));l=a.src?a.src:a.getAttribute("data-src"),d=R.getTemplateType(a)}d!==c&&-1!==u.indexOf(d)&&(c=d),null!==l&&""!==l?R.fetch(l,null,"text/plain").then(function(e){r(A(null,i,s,d,!1,e))}).catch(function(e){console.error(e),r(A(null,i,s,d,!0,"Error Downloading Template: ["+l+"], Error: "+e))}):r(A(a,i,s,d,!1,a.innerHTML))}function A(e,t,r,o,n,a){var l=null,i=null,s=!1,d=null;if(!n)try{switch(o){case h.Handlebars:l=Handlebars.compile(a);break;case h.Nunjucks:l=R.nunjucksEnvironment?nunjucks.compile(a,R.nunjucksEnvironment):nunjucks.compile(a);break;case h.Underscore:l=_.template(a);break;case h.Text:case h.Vue:i=a;break;default:throw null===e?new TypeError("Unsupported or Unknown Template View Engine when the Template was downloaded. Template type at the time of downloading = "+o):new TypeError('Unsupported or Unknown Template View Engine specified in <script id="'+e.id+'" type="'+e.type+'" data-engine="'+e.getAttribute("data-engine")+'">')}}catch(e){s=!(i=l=null),d=e}var c={id:t,url:r,type:o,engine:l,html:i,error:n||s,errorMessage:n?a:d};return R.compiledTemplates.push(c),c}function L(t,r,e,o){var n="";try{if(e.error)return void R.showError(t,C(t,r)+e.errorMessage);switch(e.type){case h.Handlebars:case h.Underscore:n=e.engine(o);break;case h.Nunjucks:n=e.engine.render(o);break;case h.Text:case h.Vue:n=e.html;break;default:throw new TypeError("Unsupported or Unknown Template View Engine: "+e.type)}null===t.getAttribute("data-set-text-content")?t.innerHTML=n:t.textContent=n}catch(e){R.showError(t,C(t,r)+e)}}function x(){var e,t,r,o,n,a,l="hash"===y?window.location.hash:window.location.pathname,i=null,s=-1;if(200<m)return R.showErrorAlert(R.settings.errors.pageLoading),m=0,void(f=!1);if(f){if(g===l)return;return window.setTimeout(x,200),void m++}if(p){if(g===l)return;return window.setTimeout(x,200),void m++}if(f=!0,(m=0)===(g=l).indexOf("#")&&(l=l.substr(1)),""===l&&(l="/"),R.unloadAllJsControls(),null!==R.activeController){for(a in R.plugins)if(R.plugins.hasOwnProperty(a)&&void 0!==R.plugins[a].onRouteUnload)try{R.plugins[a].onRouteUnload()}catch(e){R.showErrorAlert("Error from Plugin ["+a+"] on [onRouteUnload()]: "+e.toString()),console.error(e)}if(void 0!==R.activeController.onRouteUnload&&null===R.activeVueModel&&"Vue"!==R.viewEngine())try{R.activeController.onRouteUnload.apply(R.activeModel,R.activeParameters)}catch(e){R.showErrorAlert("Error from Controller [path="+R.activeController.path+"] on [onRouteUnload()]: "+e.toString()),console.error(e)}}for(null!==R.activeVueModel&&(R.activeVueModel.$destroy(),R.activeController&&R.activeController.modelName&&R.models[R.activeController.modelName]&&R.activeVueModel.$data&&(R.models[R.activeController.modelName]=JSON.parse(JSON.stringify(R.activeVueModel.$data)))),R.activeController=null,R.activeTemplate=null,R.activeModel=null,R.activeVueModel=null,R.activeParameters=[],R.activeParameterList={},v=!1,e=w=0,t=R.controllers.length;e<t;e++){if((o=R.routeMatches(l,R.controllers[e].path)).isMatch){i=R.controllers[e],R.activeParameters=o.args,R.activeParameterList=o.namedArgs;break}R.controllers[e].path===R.settings.defaultRoute&&(s=e)}if(null===i&&-1!==s){var d=R.settings.defaultRoute;if("/:lang/"===R.settings.defaultRoute&&void 0!==R.plugins.i18n&&"function"==typeof R.plugins.i18n.readSettings){R.plugins.i18n.readSettings();var c=!1;if(navigator.languages&&navigator.languages.length&&R.plugins.i18n.supportedLocales&&R.plugins.i18n.supportedLocales.length)for(e=0,t=navigator.languages.length;e<t;e++)if(-1!==R.plugins.i18n.supportedLocales.indexOf(navigator.languages[e])){d="/"+navigator.languages[e]+"/",c=!0;break}!c&&R.plugins.i18n.defaultLocale&&(d="/"+R.plugins.i18n.defaultLocale+"/")}return R.changeRoute(d),void(f=!1)}if(null===i){if(0===R.controllers.length)return R.updateView(),void(f=!1);l!==R.settings.defaultRoute&&(n="Error - The route ["+l+"] does not have a <script data-route> element or [Controller] defined. Check to make sure that a controller or script for default route ["+R.settings.defaultRoute+"] exists.",R.showError(document.querySelector(R.settings.viewSelector),n)),f=!1}else!function(e,t){if(void 0===e.settings||void 0===e.settings.lazyLoad)return M(e),t();if(null!==R.settings.lazyLoadingViewSelector){var r=document.querySelector(R.settings.viewSelector),o=document.querySelector(R.settings.lazyTemplateSelector);r&&o&&("TEMPLATE"===o.tagName||"SCRIPT"===o.tagName&&"text"===o.getAttribute("data-engine")?r.innerHTML=o.innerHTML:console.warn("Unable to show loading screen from [app.settings.lazyTemplateSelector]. Only <template> tags are allowed."))}var n=e.settings.lazyLoad.split(",").map(function(e){return e.trim()}),a=[];n.forEach(function(e){a.push(R.loadScripts(R.lazyLoad[e]))}),Promise.all(a).finally(function(){M(e),t()})}(R.activeController=i,function(){for(r in!function(e){var t,r,o;if(e.modelName)return R.activeModel=R.models[e.modelName];if(e.pageType&&void 0!==(o=R.pages[e.pageType]))if(e.viewEngine===h.Vue){for(var n in t={},e.methods=void 0===e.methods?{}:e.methods,o.model)if(o.model.hasOwnProperty(n)){var a=Object.prototype.toString.call(o.model[n]);"[object Function]"===a?e.methods[n]=o.model[n]:t[n]="[object Object]"===a?R.deepClone({},o.model[n]):"[object Array]"===a?R.deepClone([],o.model[n]):o.model[n]}}else t=R.deepClone({},o.model);void 0!==e.settings&&0<Object.keys(e.settings).length&&(void 0===t&&(t={}),R.deepClone(t,e.settings));t&&!1!==t.loadOnlyOnce&&(r=null===e.pageType||void 0===e.pageType?"Dynamic":(r=e.pageType).substring(0,1).toUpperCase()+r.substring(1),r="model_"+String(Object.keys(R.models).length)+"_"+r,R.addModel(r,t),e.modelName=r);e.modelName?R.activeModel=R.models[e.modelName]:R.activeModel=void 0===t?{}:t}(i),R.activeParameterList)R.activeParameterList.hasOwnProperty(r)&&(R.activeModel[r]=R.activeParameterList[r]);S(null,i,function(e){var r=[],o=[],n=0,a=0;function l(){if(R.activeTemplate=e,void 0!==i.onRouteLoad&&R.activeController&&R.activeController.viewEngine!==h.Vue)try{i.onRouteLoad.apply(R.activeModel,R.activeParameters)}catch(e){R.showErrorAlert("Error from Controller [path="+i.path+"] on [onRouteLoad()]: "+e.toString()),console.error(e)}window.scrollTo(0,0),R.updateView(),f=!1}for(var t in R.plugins)R.plugins.hasOwnProperty(t)&&void 0!==R.plugins[t].onRouteLoad&&(r.push(R.plugins[t].onRouteLoad),o.push(t));(0===(a=r.length)?l:function t(){try{var e=o[n];e=R.plugins[e],r[n].call(e,function(e){!1!==e?(++n===a?l:t)():f=!1})}catch(e){R.showErrorAlert("Error from Plugin ["+o[n]+"] on [onRouteLoad()]: "+e.toString()),console.error(e),R.updateView(),f=!1}})()})})}function M(e){if(null!==e.pageType&&void 0!==e.pageType&&void 0===e._pageCopied){var t=null;if(void 0===R.pages[e.pageType]?t="The page ["+e.pageType+"] has not been loaded for Controller[path="+e.path+"].":"object"!=typeof R.pages[e.pageType].model&&(t="Error - The [model] property for page object ["+e.pageType+"] must be a valid JavaScript Object."),null!==t)return e.settings=e.settings||{},e.settings.errorMessage=t,e.settings.hasError=!0,void R.showErrorAlert(t);var r=R.pages[e.pageType];for(var o in r)r.hasOwnProperty(o)&&"function"==typeof r[o]&&(e[o]=r[o]);e._pageCopied=!0}}function r(e){var t,r=new Date,o="toLocaleString"in r?r.toLocaleString():r.toString();t=-1<e.message.toLowerCase().indexOf("script error")?"Script Error at "+o+": See Browser Console for Detail":["Message: ["+e.message+"]","Time: ["+o+"]","URL: ["+e.filename+"]","Line: "+e.lineno,"Column: "+e.colno,"Error Object: "+JSON.stringify(e.error)].join(" - "),R.showErrorAlert(t),console.error(e)}if(void 0===window.DataFormsJS){var R={controllers:[],models:{},pages:{},plugins:{},controls:{},graphQL:{},lazyLoad:{},locals:{},settings:{defaultRoute:"/",viewSelector:"#view",logFetchRequests:!1,requestHeaders:{},requestHeadersByHostName:{},fetchOptions:{mode:"cors",cache:"no-store",credentials:"same-origin"},polyfillUrl:"https://polyfill.io/v3/polyfill.min.js?features=Array.from,Array.isArray,Array.prototype.find,Object.assign,URL,fetch,Promise,Promise.prototype.finally,String.prototype.endsWith,String.prototype.startsWith,String.prototype.includes,String.prototype.repeat",graphqlUrl:null,errors:{pageLoading:"Error loading the current page because the previous page is still loading and is taking a long time. Please refresh the page and try again."},lazyTemplateSelector:null},activeController:null,activeTemplate:null,activeModel:null,activeVueModel:null,activeParameters:[],activeParameterList:{},activeJsControls:[],compiledTemplates:[],onUpdateViewComplete:null,nunjucksEnvironment:null,errorClass:"dataformsjs-error",fatalErrorClass:"dataformsjs-fatal-error",errorStyleId:"dataformsjs-style-errors",errorCss:[".dataformsjs-error,.dataformsjs-fatal-error{","color:#fff;","background-color:red;","box-shadow:0 1px 5px 0 rgba(0,0,0,.5);","background-image:linear-gradient(#e00,#c00);","/*white-space:pre;*/","text-align:left;","}",".dataformsjs-error{","padding:10px;","font-size:1em;","margin:5px;","display:inline-block;","}",".dataformsjs-fatal-error{","z-index:1000000;","padding:20px;","font-size:1.5em;","margin:20px;","position:fixed;","top:10px;","}","@media only screen and (min-width:1000px){",".dataformsjs-fatal-error{","max-width:1000px;","left:calc(50% - 520px);","}","}",".dataformsjs-fatal-error span{","padding:5px 10px;","float:right;","border:1px solid darkred;","cursor:pointer;","margin-left:10px;","box-shadow:0 0 2px 1px rgba(0,0,0,0.3);","background-image:linear-gradient(#c00,#a00);","border-radius:5px;","}"].join(""),vueStyleId:"dataformsjs-style-vue-cloak",vueCss:"[v-cloak] { display: none !important; }",escapeHtml:function(e){return null==e||"number"==typeof e?e:String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},fetch:function(t,e,r){var o=R.deepClone({},R.settings.fetchOptions);if(o.headers=R.getRequestHeaders(t),e&&(Object.assign(o,e),void 0!==e.headers&&(o.headers=Object.assign({},R.getRequestHeaders(t),e.headers))),a&&(void 0===o.method||"GET"===o.method||"HEAD"===o.method)&&("no-store"===o.cache||"no-cache"===o.cache)){var n=/([?&])_=[^&]*/;if(n.test(t))t=t.replace(n,"$1_="+(new Date).getTime());else{t+=(/\?/.test(t)?"&":"?")+"_="+(new Date).getTime()}}return fetch(t,o).then(function(e){return R.settings.logFetchRequests&&R.events&&"function"==typeof R.events.dispatch&&R.events.dispatch("fetch",{url:t,status:e.status}),Promise.resolve(e)}).then(function(e){var t=e.status;if(200<=t&&t<300||304===t)return Promise.resolve(e);var r="Error loading data. Server Response Code: "+t+", Response Text: "+e.statusText;return Promise.reject(r)}).then(function(e){var t=void 0===r?"application/json":r;return e.headers.has("Content-Type")&&(t=e.headers.get("Content-Type")),0===t.indexOf("application/json")?e.json():e.text()})},routingMode:function(){return y},changeRoute:function(e){if("string"!=typeof e)throw new TypeError("Expected string for app.changeRoute(path)");"history"===y?(window.history.pushState(null,null,e),x()):window.location.hash=0===e.indexOf("#")?e:"#"+e},pushStateClick:function(e){if(!0!==e.ctrlKey)return e.preventDefault(),e.stopPropagation(),e.currentTarget.href?R.changeRoute(e.currentTarget.href):console.error("app.pushStateClick() called for an unknown link"),!1},addPage:function(e,t){var r=["onRouteLoad","onBeforeRender","onRendered","onRouteUnload"];return i(e,"string","name","app.addPage()"),n(e,"name","app.addPage()"),i(t,"object","page","app.addPage()"),d(t,e,"page",r),r.pop(),E(t,e,"page",r),o(t.model,"page."+e+".model","app.addPage()"),l(this.pages,"app.pages",e),this.pages[e]=t,this},addPlugin:function(e,t){if(i(e,"string","name","app.addPlugin()"),n(e,"name","app.addPlugin()"),l(this.plugins,"app.plugins",e),"function"==typeof t)return this.plugins[e]={onRendered:t},this;var r=["onRouteLoad","onBeforeRender","onRendered","onRouteUnload"];return i(t,"object","plugin","app.addPlugin()"),d(t,e,"plugin",r),r.pop(),E(t,e,"plugin",r),this.plugins[e]=t,this},addControl:function(e,t){if(i(e,"string","name","app.addControl()"),n(e,"name","app.addControl()"),e!==e.toLowerCase())throw new TypeError("Control names must be all lower-case. [app.addControl()] was called with: ["+e+"]");if(-1===e.indexOf("-"))throw new TypeError("Control names must contain a dash [-] character. [app.addControl()] was called with: ["+e+"]");if(-1!==e.indexOf(" "))throw new TypeError("Control names cannot contain a space. [app.addControl()] was called with: ["+e+"]");if(!1!==/[&<>"'/]/.test(e))throw new TypeError("Control names cannot contain HTML characters that need to be escaped. Invalid characters are [& < > \" ' /]. [app.addControl()] was called with: ["+e+"]");i(t,"object","control","app.addControl()"),void 0!==t.css&&i(t.css,"string","control.css","app.addControl()");var r=["onLoad","html","onUnload"];return E(t,e,"control",r),d(t,e,"control",r),r.pop(),E(t,e,"control",r),l(this.controls,"app.controls",e),this.controls[e]=t,this},addModel:function(e,t){return i(e,"string","name","app.addModel()"),n(e,"name","app.addModel()"),i(t,"object","model","app.addModel()"),l(this.models,"app.models",e),this.models[e]=t,this},addController:function(t){var e,r=["onRouteLoad","onBeforeRender","onRendered","onRouteUnload"];if(i(t,"object","controller","app.addController()"),i(t.path,"string","controller.path","app.addController()"),n(t.path,"controller.path","app.addController()"),this.controllers.forEach(function(e){if(e.path===t.path)throw new TypeError("[app.controllers(path="+t.path+")] is already defined")}),e="app.addController(path="+t.path+")",void 0===t.viewId?t.viewId=null:(i(t.viewId,"string","controller.viewId",e),n(t.viewId,"controller.viewId",e),function(e,t,r){if(null===document.getElementById(e))throw new TypeError("An element was not found on the page with ["+t+"][id="+e+"] when the function "+r+" was called")}(t.viewId,"controller.viewId",e)),void 0===t.viewUrl?t.viewUrl=null:(i(t.viewUrl,"string","controller.viewUrl",e),n(t.viewUrl,"controller.viewUrl",e)),null!==t.viewId&&null!==t.viewUrl)throw new TypeError("A controller cannot have both [viewId] and [viewUrl] defined when calling "+e);if(void 0!==t.viewEngine){if(null===t.viewId&&null===t.viewUrl)throw new TypeError("When a controller uses the [viewEngine] property either [viewId] or [viewUrl] must also be defined when calling "+e);if(-1===u.indexOf(t.viewEngine))throw new TypeError("Invalid [viewEngine] property when calling "+e+". Valid values are: "+u.join(", "))}return null!==t.modelName&&void 0!==t.modelName&&(i(t.modelName,"string","controller.modelName",e),n(t.modelName,"controller.modelName",e),o(this.models[t.modelName],"app.models."+t.modelName,e)),null!==t.pageType&&void 0!==t.pageType&&(i(t.pageType,"string","controller.pageType",e),n(t.pageType,"controller.pageType",e)),d(t,t.path,"controller",r),null!==t.pageType&&void 0!==t.pageType||(r.pop(),r.push("viewId"),r.push("viewUrl"),E(t,t.path,"controller",r)),this.controllers.push(t),this},controller:function(e){for(var t=0,r=this.controllers.length;t<r;t++)if(this.controllers[t].path===e)return this.controllers[t];return null},showError:function(e,t){if(null!==e){R.loadCss(R.errorStyleId,R.errorCss);var r=b("span",t,R.errorClass);e.innerHTML="",e.appendChild(r),"string"!=typeof t&&console.error(t)}else R.showErrorAlert(t)},showErrorAlert:function(e){R.loadCss(R.errorStyleId,R.errorCss),"string"==typeof e&&-1===e.toLowerCase().indexOf("error")&&(e="Error: "+e);var t=b("div",e,R.fatalErrorClass),r=b("span","âœ•");r.onclick=function(){document.body.removeChild(t)},t.insertBefore(r,t.firstChild),document.body.appendChild(t),"string"!=typeof e&&console.error(e)},isUpdatingView:function(){return p},updateView:function(){function e(){if(p=!0,null!==R.activeVueModel){var e=0,t=R.activeVueModel._watcher;return t&&t.deps&&t.deps.length&&(e=t.deps.length),w!==e&&a("vue_dep_change"),p=!(v=!0),void(w=e)}R.unloadAllJsControls();try{if(!(R.activeController&&R.activeController.viewEngine===h.Vue)&&R.activeController&&void 0!==R.activeController.onBeforeRender)try{R.activeController.onBeforeRender.apply(R.activeModel,R.activeParameters)}catch(e){R.showErrorAlert("Error from Controller [path="+R.activeController.path+"] on [onBeforeRender()]: "+e.toString()),console.error(e)}for(var r in R.plugins)if(R.plugins.hasOwnProperty(r)&&void 0!==R.plugins[r].onBeforeRender)try{R.plugins[r].onBeforeRender()}catch(e){R.showErrorAlert("Error from Plugin ["+r+"] on [onBeforeRender()]: "+e.toString()),console.error(e)}if(null!==R.activeTemplate){var o=document.querySelector(R.settings.viewSelector);if(null===o){var n="Error - The main HTML element for rendering views from selector ["+R.settings.viewSelector+"] does not exist on this page. Check HTML on the page to makes sure that the element exist; and if it does then check to make sure that JavaScript Code did not remove it from the page";R.showErrorAlert(n)}else L(o,R.activeController,R.activeTemplate,R.activeModel)}R.refreshAllHtmlControls(function(){if(R.activeController&&R.activeController.viewEngine===h.Vue){var t=document.querySelector(R.settings.viewSelector);Vue.config.errorHandler=function(e){console.error("Vue Error"),T(e,t)},Vue.config.warnHandler=function(e){console.error("Vue Warning"),T(e,t)},R.activeTemplate&&R.activeTemplate.error?(R.showError(document.querySelector(R.settings.viewSelector),R.activeTemplate.errorMessage),a("updateView")):R.activeVueModel=new Vue({el:R.settings.viewSelector,data:R.activeModel,methods:R.activeController.methods,computed:R.activeController.computed,mounted:function(){var e=this;e.$nextTick(function(){if(void 0!==R.activeController.onRouteLoad)try{R.activeController.onRouteLoad.apply(e,R.activeParameters)}catch(e){R.showErrorAlert("Error from Controller [path="+R.activeController.path+"] on [onRouteLoad()]: "+e.toString()),console.error(e)}R.loadAllJsControls(),a("vue_mounted",e)})},updated:function(){this.$nextTick(function(){if(v){R.loadAllJsControls(),a("vue_updated");var e=this._watcher;e&&e.deps&&e.deps.length&&(w=this._watcher.deps.length),v=!1}})},beforeDestroy:function(){try{void 0!==R.activeController.onRouteUnload&&R.activeController.onRouteUnload.apply(this,R.activeParameters)}catch(e){R.showErrorAlert("Error from Controller [path="+R.activeController.path+"] on [onRouteUnload()]: "+e.toString()),console.error(e)}}})}else R.loadAllJsControls(),a("updateView");p=!1})}catch(e){throw p=!1,console.error(e),e}}function a(e,t){if("history"===y){var r=document.querySelectorAll('a[href^="/"]:not([data-no-pushstate])');Array.prototype.forEach.call(r,function(e){e.addEventListener("click",R.pushStateClick)})}for(var o in R.plugins)if(R.plugins.hasOwnProperty(o)&&void 0!==R.plugins[o].onRendered)try{R.plugins[o].onRendered()}catch(e){R.showErrorAlert("Error from Plugin ["+o+"] on [onRendered()]: "+e.toString()),console.error(e)}var n=R.activeController&&R.activeController.viewEngine===h.Vue,a=R.activeController&&R.activeController.onRendered;if("function"==typeof a){t=n?t||R.activeVueModel:R.activeModel;try{a.apply(t,R.activeParameters)}catch(e){R.showErrorAlert("Error from Controller [path="+R.activeController.path+"] on [onRendered()]: "+e.toString()),console.error(e)}}if(null!==R.onUpdateViewComplete)try{R.onUpdateViewComplete(e)}catch(e){R.showErrorAlert("Error from [app.onUpdateViewComplete()]: "+e.toString()),console.error(e)}}p?t=window.setInterval(function(){p||(window.clearInterval(t),t=null,e())},10):e()},refreshAllHtmlControls:function(e,o){var n=String((new Date).getTime()),a='[data-template-id]:not([data-updated-at="'+n+'"])';a+=',[data-template-url]:not([data-updated-at="'+n+'"])',s=!0,function t(r){if(null===r)s=!1,p||R.refreshPlugins(),e&&e(n);else try{R.refreshHtmlControl(r,function(){r.setAttribute("data-updated-at",n),t(document.querySelector(a))},o)}catch(e){r.setAttribute("data-updated-at",n),t(document.querySelector(a))}}(document.querySelector(a))},refreshHtmlControl:function(t,r,o){try{var e="string"==typeof t,n=t instanceof HTMLElement;if(!e&&!n)throw new TypeError("Invalid type for parameter [control] in the function [DataFormsJS.refreshHtmlControl()]: "+typeof t);if(e){var a=t;if(null===(t=document.getElementById(a)))throw new TypeError("Control not found for ["+a+"] when the function [DataFormsJS.refreshHtmlControl()] was called.")}if(void 0!==r&&"function"!=typeof r)throw new TypeError("[callback] was not defined as a [function] when the [DataFormsJS.refreshHtmlControl()] was called");var l=t.getAttribute("data-template-id"),i=t.getAttribute("data-template-url");if(null!==l&&null!==i)throw new TypeError("A control must have only one of the template attribute defined; either [data-template-id] or [data-template-url]. Both attributes are defined on the control.");if(null===l&&null===i)throw new TypeError("A control must have either attribute [data-template-id] or [data-template-url]. Niether attribute is defined for the control.");void 0===o&&(o=this.activeModel),S(t,null,function(e){L(t,null,e,o),p||R.loadAllJsControls(t,o),s||R.refreshPlugins(t),void 0!==r&&r()})}catch(e){throw console.error(e),null!==t&&t instanceof HTMLElement&&R.showError(t,C(t,null)+e.message),e}},refreshPlugins:function(e){function t(){for(var t in R.plugins)if(R.plugins.hasOwnProperty(t)&&void 0!==R.plugins[t].onRendered)try{void 0===e?R.plugins[t].onRendered():1===R.plugins[t].onRendered.length&&R.plugins[t].onRendered(e)}catch(e){R.showErrorAlert("Error from Plugin ["+t+"] on [onRendered()]: "+e.toString()),console.error(e)}}R.activeController&&R.activeController.viewEngine===h.Vue?R.activeVueModel.$nextTick(t):t()},loadAllJsControls:function(r,o){var t=["[data-control]:not([data-control-loaded]):not([data-control-is-loading])"];Object.keys(R.controls).forEach(function(e){-1!==e.indexOf("-")&&-1===e.indexOf(" ")&&t.push(e+":not([data-control-loaded]):not([data-control-is-loading])")});var n=t.join(",");void 0===r&&(r=document),void 0===o&&(o=R.activeModel),function e(t){if(null!==t){try{R.loadJsControl(t,o)}catch(e){t.setAttribute("data-control-loaded",""),R.showError(t,e.toString()),console.error(e)}e(r.querySelector(n))}}(r.querySelector(n))},loadJsControl:function(t,e){var r,o,n,a,l,i,s,d,c,u,p;if(!(t instanceof HTMLElement))throw new TypeError("Invalid type for parameter [element] for the function [DataFormsJS.loadJsControl()], expected HTMLElement, received: "+typeof t);if(r=t.getAttribute("data-control"),o=t.tagName.toLowerCase(),null===r||r===o){if(r=o,void 0===(n=R.controls[r]))throw u="Invalid call to [DataFormsJS.loadJsControl()]. This function only works on valid control elements.",R.showError(t,u),console.log(t),new TypeError(u);for(d=n.type||"div",l=document.createElement(d);t.firstChild;)l.appendChild(t.firstChild);for(i=0,s=t.attributes.length;i<s;i++)l.setAttribute(t.attributes[i].name,t.attributes[i].value);l.setAttribute("data-control",r),t.parentNode.replaceChild(l,t),t=l}else if(void 0===(n=R.controls[r]))throw new Error("JavaScript Control was not found by name, check that the file is loaded: "+r);for(c in a=void 0===n.data?{}:R.deepClone({},n.data),t.dataset)"control"!==c&&(a[c]=t.dataset[c]);if(void 0!==n.css&&R.loadCss("DataFormsJS-control-style-"+r,n.css),void 0===e&&(e=R.activeModel),null===t.getAttribute("data-control-is-loading")){t.setAttribute("data-control-is-loading",""),p=!1;try{void 0!==n.onLoad&&n.onLoad.call(a,t)}catch(e){R.showError(t,"Error with JavaScript Control ["+r+"] in function [onLoad()]: "+e.toString()),console.error(e),p=!0}if(!p)try{void 0!==n.html&&(t.innerHTML=n.html.call(a,e))}catch(e){R.showError(t,"Error with JavaScript Control ["+r+"] in function [html()]: "+e.toString()),console.error(e)}t.setAttribute("data-control-loaded",""),t.removeAttribute("data-control-is-loading"),R.activeJsControls.push({element:t,control:r,data:a})}},unloadAllJsControls:function(){R.activeJsControls.forEach(function(t){var e=R.controls[t.control];if(void 0!==e.onUnload)try{e.onUnload.call(t.data,t.element)}catch(e){var r="Unknown Control";t.element&&(r=(r=t.element.getAttribute("data-control"))||"Unknown Control"),R.showErrorAlert("Error with JavaScript Control ["+r+"] in function [onUnload()]: "+e.toString()),console.error(e)}t.element.removeAttribute("data-control-loaded")}),R.activeJsControls=[]},routeMatches:function(e,t){var r,o,n=e.split("/"),a=t.split("/"),l=n.length,i=[],s={};if(l!==a.length)return{isMatch:!1};for(r=0;r<l;r++)if((o=decodeURIComponent(n[r]))!==a[r]){if(":"!==a[r].substr(0,1))return{isMatch:!1};i.push(o),s[a[r].substr(1)]=o}return{isMatch:!0,args:i,namedArgs:s}},deepClone:function(){var e,t,r,o,n,a,l=arguments.length;if(0===l)throw new TypeError("No arguments specified when app.deepClone() was called.");if(1===l)throw new TypeError("Only one argument was specified when app.deepClone() was called.");for(e=0;e<l;e++)i(arguments[e],"object","argument","app.deepClone()");for(t=arguments[0],e=1;e<l;e++)for(o in r=arguments[e])r.hasOwnProperty(o)&&(void 0!==(a=Object.getOwnPropertyDescriptor(r,o)).get||void 0!==a.set?Object.defineProperty(t,o,a):(n=Object.prototype.toString.call(r[o]),t[o]="[object Object]"===n?this.deepClone({},r[o]):"[object Array]"===n?this.deepClone([],r[o]):r[o]));return t},getTemplateType:function(e){if(void 0===e)throw new TypeError("Missing parameter [script] for the function [DataFormsJS.getTemplateType()]");if(!(e instanceof HTMLElement))throw new TypeError("Invalid type for parameter [script] for the function [DataFormsJS.getTemplateType()], expected HTMLElement, received: "+typeof e);if("TEMPLATE"!==e.tagName&&"SCRIPT"!==e.tagName)throw new TypeError("Invalid type for parameter [script] for the function [DataFormsJS.getTemplateType()], expected <script> or <template>, received: "+e.tagName.toLowerCase());if("TEMPLATE"===e.tagName)return h.Text;switch(e.getAttribute("data-engine")){case"handlebars":return h.Handlebars;case"vue":return h.Vue;case"nunjucks":return h.Nunjucks;case"underscore":return h.Underscore;case"text":return h.Text;default:return h.Unknown}},viewEngine:function(e){if(void 0===e)return c;switch(e){case h.NotSet:case h.Unknown:case h.Mixed:throw new TypeError("Invalid value specified for setting the ViewEngine: "+e);default:if(void 0===h[e])throw new TypeError("Unknown value specified for setting the ViewEngine ["+e+"], refer to documentation or values from the enum/object [ViewEngines] for valid options.")}return c=e,this},loadCss:function(e,t){var r=document.getElementById(e);null===r&&((r=document.createElement("style")).id=e,r.innerHTML=t,document.head.appendChild(r))},loadScript:function(e,o,t){function r(e,t){var r=document.createElement("script");r.onload=e,r.onerror=function(){console.error("Error loading Script: "+o),t()},r.src=o,document.head.appendChild(r)}if(!1===e||void 0===e){if(void 0===t)return new Promise(function(e,t){r(e,t)});r(t,t)}else{if(void 0===t)return new Promise(function(e){e()});t()}},loadScripts:function(i){if("string"==typeof i)i=[i];else if(!Array.isArray(i))return R.showErrorAlert("Invalid Script for [app.loadScripts()] or [app.lazyLoad], expected string or an array of strings. Check console."),console.log("app.loadScripts():"),console.log(i),new Promise(function(e){e()});return new Promise(function(r){var o=0,n=i.length;!function e(){if(o!==n){var a,l,t=i[o];o++,t.endsWith(".js")?(l=t,new Promise(function(e){for(var t=document.querySelectorAll("script"),r=0,o=t.length;r<o;r++)if(t[r].getAttribute("src")===l)return void e();var n=document.createElement("script");n.onload=e,n.onerror=function(){R.showErrorAlert("Error loading JS File: "+l),e()},n.src=l,document.head.appendChild(n)})).then(e):t.endsWith(".css")?(a=t,new Promise(function(e){for(var t=document.querySelectorAll("link"),r=0,o=t.length;r<o;r++)if("stylesheet"===t[r].rel&&t[r].getAttribute("href")===a)return void e();var n=document.createElement("link");n.rel="stylesheet",n.onload=e,n.onerror=function(){R.showErrorAlert("Error loading CSS File: "+a),e()},n.href=a,document.head.appendChild(n)})).then(e):(R.showErrorAlert("Invalid Script for [app.loadScripts()] or [app.lazyLoad]: "+t),e())}else r()}()})},buildUrl:function(e,t){if(void 0===t&&(t=R.activeParameterList),null!==t&&0<Object.keys(t).length)for(var r in t)t.hasOwnProperty(r)&&-1<e.indexOf(":"+r)&&(e=e.replace(new RegExp(":"+r,"g"),encodeURIComponent(t[r])));return e},getGraphQL:function(o,r){var n,a;return o&&r?new Promise(function(e,t){t('Error calling [app.getGraphQL()]. Both [id="'+o+'"] and [src="'+r+'"] are set. Only one value can be used.')}):(n=o||r)&&void 0!==R.graphQL[n]?new Promise(function(e,t){R.graphQL[n].query?e(R.graphQL[n].query):t(R.graphQL[n].error)}):o?new Promise(function(e,t){var r=null;null===(a=document.getElementById(o))?r="Missing GraphQL Script Element: "+o:"SCRIPT"!==a.nodeName||"application/graphql"!==a.type?r='Invalid Element for GraphQL Script, expected: <script type="application/graphql" id="'+o+'">':(R.graphQL[o]={query:a.innerHTML,error:null},e(a.innerHTML)),null!==r&&(R.graphQL[o]={query:null,error:r},t(r))}):r?R.fetch(r,null,"text/plain").then(function(e){return R.graphQL[r]={query:e,error:null},e}).catch(function(e){var t="Error Downloading GraphQL Script: ["+r+"], Error: "+e;throw R.graphQL[r]={query:null,error:t},t}):new Promise(function(e,t){t("Error calling [app.getGraphQL()]. Missing GraphQL Parameters.")})},buildGraphQLVariables:function(e,t){var r={};if(0<Object.keys(t).length)for(var o in t)if(t.hasOwnProperty(o)&&-1<e.indexOf("$"+o)){var n=-1!==e.indexOf("($"+o+": Int"),a=t[o];r[o]=n?Number(a):a}return r},handleGlobalErrors:function(e){e?window.addEventListener("error",r):window.removeEventListener("error",r)},getRequestHeaders:function(e){var t,r,o,n={};for(r in t=R.settings.requestHeaders)t.hasOwnProperty(r)&&(n[r]=t[r]);if(0<Object.keys(R.settings.requestHeadersByHostName).length&&(o=new URL(e,window.location).hostname,void 0!==(t=R.settings.requestHeadersByHostName[o])))for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n},setup:function(){c=h.Unknown;var e,t=0,r=[{prop:"Handlebars",type:"handlebars",label:h.Handlebars},{prop:"Vue",type:"vue",label:h.Vue},{prop:"nunjucks",type:"nunjucks",label:h.Nunjucks},{prop:"_",type:"underscore",label:h.Underscore}];for(e in r)null!==document.querySelector('script[type="text/x-template"][data-engine="'+r[e].type+'"]')&&(c=r[e].label,t++);if(0===t)for(e in r)window[r[e].prop]&&(c=r[e].label,t++);if(1<t&&(c=h.Mixed),void 0!==window.Vue&&R.loadCss(R.vueStyleId,R.vueCss),null!==document.documentElement.getAttribute("data-show-errors")&&R.handleGlobalErrors(!0),R.settings.graphqlUrl=document.documentElement.getAttribute("data-graphql-url"),null===y&&"history"!==(y=document.documentElement.getAttribute("data-routing-mode"))&&(y="hash"),a){var o=document.querySelectorAll("template");Array.prototype.forEach.call(o,function(e){for(var t=document.createElement("script"),r=0,o=e.attributes.length;r<o;r++)t.setAttribute(e.attributes[r].name,e.attributes[r].value);t.type="text/x-template",t.setAttribute("data-engine","text"),t.innerHTML=e.innerHTML,e.parentNode.replaceChild(t,e)})}var n=document.querySelectorAll('script[type="text/x-template"][data-route],template[data-route]');Array.prototype.forEach.call(n,function(e){var t=e.getAttribute("data-route"),r=e.id,o=e.src?e.src:e.getAttribute("data-src"),n=e.getAttribute("data-page"),a=e.getAttribute("data-model"),l=e.getAttribute("data-controller-added"),i=R.getTemplateType(e),s=e.getAttribute("data-default-route"),d=0,c={};if(null===l){if(""===t)return console.log(e),void R.showErrorAlert(new TypeError('A script element <script id="'+e.id+'" type="'+e.type+'" data-engine="'+e.getAttribute("data-engine")+'"> has the attribute [data-route] defined however the attribute value is empty. This error must be fixed, scripts that include a route path attribute must have the value defined.'));if(i===h.Unknown)return console.log(e),void R.showErrorAlert(new TypeError('A script element <script id="'+e.id+'" type="'+e.type+'" data-engine="'+e.getAttribute("data-engine")+'" data-route="'+e.getAttribute("data-route")+'"> must have a valid engine type defined in [data-engine]. Valid values are [handlebars, vue, underscore, nunjucks, text].'));if(""===r&&(""===o||null===o))for(;r="template"+d,null===document.querySelector("#"+r)&&(e.id=r),d++,""===e.id;);""===o||null===o?o=void 0:r=void 0;var u=["route","page","model","src","engine"];for(var p in e.dataset)if(-1===u.indexOf(p)){var f=e.dataset[p];switch(f){case"true":c[p]=!0;break;case"false":c[p]=!1;break;default:c[p]=f}}try{R.addController({path:t,viewId:r,viewUrl:o,viewEngine:i,pageType:n,modelName:a,settings:c}),null!==s&&(R.settings.defaultRoute=t)}catch(e){R.showErrorAlert("Error from [app.setup()]: "+e),console.error(e)}e.setAttribute("data-controller-added","true")}}),"hash"===y?window.addEventListener("hashchange",x):window.addEventListener("popstate",x),x()}};window.DataFormsJS=R,void 0===window.app?window.app=R:R.showErrorAlert("Warning - [window.app] is already defined, pages, plugins, etc. may not load correctly."),document.addEventListener("DOMContentLoaded",function(){var e=!!(Array.from&&window.Promise&&window.fetch&&Promise.prototype.finally);R.loadScript(e,R.settings.polyfillUrl,R.setup)})}}();