// @link https://www.dataformsjs.com
// @version 5.11.0
// @author Conrad Sollitt (https://conradsollitt.com)
// @license MIT
!function(){"use strict";var h,g={NotSet:"Not Set",Unknown:"Unknown",Mixed:"Mixed",Handlebars:"Handlebars",Vue:"Vue",Nunjucks:"Nunjucks",Underscore:"Underscore",Text:"Text"},c=g.NotSet,p=[g.Handlebars,g.Vue,g.Nunjucks,g.Underscore,g.Text],v=!1,s=!1,m=!1,C=null,E=0,t=null,w=!1,b=0,n=-1!==navigator.userAgent.indexOf("Trident/"),y=null,a=!1;function l(e,t,o,r){if(typeof e!==t)throw console.log(e),new TypeError("["+o+"] was not defined as a "+t+" when the function "+r+" was called")}function d(e,t,o){if(void 0===e)throw new TypeError("["+t+"] must first be defined before the function "+o+" is called");if("object"!=typeof e)throw console.log(e),new TypeError("["+t+"] was not defined as an object when the function "+o+" was called")}function i(e,t,o){if(""===e)throw new TypeError("["+t+"] must have a value when defined when the function "+o+" is called")}function f(e,t,o){if(void 0!==e[o])throw console.log(e),new TypeError("["+t+"."+o+"] is already defined")}function T(e,t,o,r){for(var n=0,a=r.length;n<a;n++)if(void 0!==e[r[n]]&&"function"!=typeof e[r[n]])throw console.log(e),new TypeError(o+"["+t+"]."+r[n]+" is not defined as a function.")}function S(e,t,o,r){for(var n=0,a=r.length;n<a;n++)if(void 0!==e[r[n]]&&null!==e[r[n]])return;throw console.log(e),new TypeError(o+"["+t+"] must have one of the following properties defined: "+r.join(", "))}function A(e,t){var o,r,n="";try{return null!==t&&t.path?n='Error with [Controller.path = "'+t.path+'"] - ':null!==e&&e instanceof HTMLElement&&(o=e.getAttribute("data-template-id"),r=e.getAttribute("data-template-url"),o=null===o?"":' data-template-id="'+o+'"',r=null===r?"":' data-template-url="'+r+'"',n="Error with Element <"+e.tagName.toLowerCase(),n=(n+=' id="'+e.id+'"')+' class="'+e.className+'"'+(o+r)+"> - "),n}catch(e){return console.error(e),n}}function r(e,t,o){e=document.createElement(e);return e.textContent=t,o&&(e.className=o),e}function L(e,t){console.error(e),window.setTimeout(function(){t&&null===t.parentNode&&((document.querySelector("body")||document.documentElement).appendChild(t),h.activeTemplate&&(h.activeTemplate.error=!0,h.activeTemplate.errorMessage=e.toString())),h.showError(t,e)},500)}function R(e,t,o){var r,n,a=null,l=null,i=null,s=null,d=null;if(null===t)i=e.getAttribute("data-template-id"),s=e.getAttribute("data-template-url"),null!==h.activeController&&(d=h.activeController.viewEngine);else{if(i=t.viewId,s=t.viewUrl,void 0!==t.viewEngine&&(d=t.viewEngine),void 0===s&&(s=null),null!==(i=void 0===i?null:i)&&null!==s)return void o(u(null,i,s,d,!0,"A controller must have either [viewId] or [viewUrl] defined but not both properties. This error is not possible when calling the [addController()] so one or more of the properties were modified by JavaScript code after the controller was already added."));if(null===i&&null===s)return"function"==typeof t.onRouteLoad||"function"==typeof t.onBeforeRender||"function"==typeof t.onRendered?void o(null):void o(u(null,i,s,d,!0,"A controller must have either [viewId] or [viewUrl] defined but neither property is defined. This error is not possible when calling the [addController()] so one or more of the properties were modified by JavaScript code after the controller was already added."))}for(r=0,n=h.compiledTemplates.length;r<n;r++){if(null!==i&&h.compiledTemplates[r].id===i)return void o(h.compiledTemplates[r]);if(null!==s&&h.compiledTemplates[r].url===s)return void o(h.compiledTemplates[r])}if(null!==s)l=s,null===d&&(d=c);else{if(null===(a=document.getElementById(i)))return void o(u(e,i,s,d,!0,"Script Tag for Template ID ["+i+"] does not exist."));l=a.src||a.getAttribute("data-src"),d=h.getTemplateType(a)}d!==c&&-1!==p.indexOf(d)&&(c=d),null!==l&&""!==l?h.fetch(l,null,"text/plain").then(function(e){o(u(null,i,s,d,!1,e))}).catch(function(e){console.error(e),o(u(null,i,s,d,!0,"Error Downloading Template: ["+l+"], Error: "+e))}):o(u(a,i,s,d,!1,a.innerHTML))}function u(e,t,o,r,n,a){var l=null,i=null,s=!1,d=null;if(!n)try{switch(r){case g.Handlebars:l=Handlebars.compile(a);break;case g.Nunjucks:l=h.nunjucksEnvironment?nunjucks.compile(a,h.nunjucksEnvironment):nunjucks.compile(a);break;case g.Underscore:l=_.template(a);break;case g.Text:case g.Vue:i=a;break;default:throw null===e?new TypeError("Unsupported or Unknown Template View Engine when the Template was downloaded. Template type at the time of downloading = "+r):new TypeError('Unsupported or Unknown Template View Engine specified in <script id="'+e.id+'" type="'+e.type+'" data-engine="'+e.getAttribute("data-engine")+'">')}}catch(e){s=!(i=l=null),d=e}t={id:t,url:o,type:r,engine:l,html:i,error:n||s,errorMessage:n?a:d};return h.compiledTemplates.push(t),t}function U(t,o,e,r){var n="";try{if(e.error)return void h.showError(t,A(t,o)+e.errorMessage);switch(e.type){case g.Handlebars:case g.Underscore:n=e.engine(r);break;case g.Nunjucks:n=e.engine.render(r);break;case g.Text:case g.Vue:n=e.html;break;default:throw new TypeError("Unsupported or Unknown Template View Engine: "+e.type)}null===t.getAttribute("data-set-text-content")?t.innerHTML=n:t.textContent=n,h.updateTemplatesForIE(t)}catch(e){h.showError(t,A(t,o)+e)}}function V(){var e,s,d,t,o,r,n,u,a,l,p,i="hash"===y?window.location.hash:window.location.pathname,c=null,f=-1;if(200<E)return h.showErrorAlert(h.settings.errors.pageLoading),E=0,void(m=!1);if(m)return C===i?void 0:(window.setTimeout(V,200),void E++);if(v)return C===i?void 0:(window.setTimeout(V,200),void E++);for(o in m=!0,""===(i=(E=0)===(C=i).indexOf("#")?i.substring(1):i)&&(i="/"),h.plugins)if(h.plugins.hasOwnProperty(o)&&void 0!==h.plugins[o].onAllowRouteChange)try{if(!1===h.plugins[o].onAllowRouteChange(i))return void(m=!1)}catch(e){h.showErrorAlert("Error from Plugin ["+o+"] on [onAllowRouteChange()]: "+e.toString()),console.error(e)}if(h.unloadAllJsControls(),null!==h.activeController){for(o in h.plugins)if(h.plugins.hasOwnProperty(o)&&void 0!==h.plugins[o].onRouteUnload)try{h.plugins[o].onRouteUnload()}catch(e){h.showErrorAlert("Error from Plugin ["+o+"] on [onRouteUnload()]: "+e.toString()),console.error(e)}if(void 0!==h.activeController.onRouteUnload&&null===h.activeVueModel&&"Vue"!==h.viewEngine())try{h.activeController.onRouteUnload.apply(h.activeModel,h.activeParameters)}catch(e){h.showErrorAlert("Error from Controller [path="+h.activeController.path+"] on [onRouteUnload()]: "+e.toString()),console.error(e)}}for(null!==h.activeVueModel&&(null===h.activeVueApp?(h.activeVueModel.$destroy(),h.settings.clearVue2WatchersOnRouteUnload&&h.activeController&&h.activeController.modelName&&h.models[h.activeController.modelName]&&h.activeVueModel.$data&&(h.models[h.activeController.modelName]=JSON.parse(JSON.stringify(h.activeVueModel.$data)))):h.activeVueApp.unmount()),h.activeController=null,h.activeTemplate=null,h.activeModel=null,h.activeVueModel=null,h.activeVueApp=null,h.activeParameters=[],h.activeParameterList={},w=!1,e=b=0,s=h.controllers.length;e<s;e++){if((t=h.routeMatches(i,h.controllers[e].path)).isMatch){c=h.controllers[e],h.activeParameters=t.args,h.activeParameterList=t.namedArgs;break}h.controllers[e].path===h.settings.defaultRoute&&(f=e)}if(null===c&&-1!==f)return a=h.settings.defaultRoute,"/:lang/"===h.settings.defaultRoute&&void 0!==h.plugins.i18n&&"function"==typeof h.plugins.i18n.readSettings&&"function"==typeof h.plugins.i18n.getUserDefaultLang&&(h.plugins.i18n.readSettings(),null!==(r=h.plugins.i18n.getUserDefaultLang())&&(a="/"+r+"/")),h.changeRoute(a),void(m=!1);if(null===c){if(0===h.controllers.length)return h.updateView(),void(m=!1);i!==h.settings.defaultRoute&&(r="Error - The route ["+i+"] does not have a <script data-route> element or [Controller] defined. Check to make sure that a controller or script for default route ["+h.settings.defaultRoute+"] exists.",h.showError(document.querySelector(h.settings.viewSelector),r)),m=!1}else h.activeController=c,u=function(){var e,t,o,r,n,a=c;if(a.modelName)h.activeModel=h.models[a.modelName];else{if(a.pageType&&void 0!==(o=h.pages[a.pageType]))if(a.viewEngine===g.Vue)if(e={},a.methods=void 0===a.methods?{}:a.methods,"function"==typeof o){e=new o;for(var l=h.getClassFunctionNames(o),i=["constructor","onRouteLoad","onBeforeRender","onRendered","onRouteUnload"],s=0;s<l.length;s++)r=l[s],i.includes(r)||(a.methods[r]=o.prototype[r])}else for(r in o.model)o.model.hasOwnProperty(r)&&("[object Function]"===(n=Object.prototype.toString.call(o.model[r]))?a.methods[r]=o.model[r]:e[r]="[object Object]"===n?h.deepClone({},o.model[r]):"[object Array]"===n?h.deepClone([],o.model[r]):o.model[r]);else e="function"==typeof o?new o:h.deepClone({},o.model);void 0!==a.settings&&0<Object.keys(a.settings).length&&(void 0===e&&(e={}),h.deepClone(e,a.settings)),e&&!1!==e.loadOnlyOnce&&(t=null===a.pageType||void 0===a.pageType?"Dynamic":(t=a.pageType).substring(0,1).toUpperCase()+t.substring(1),t="model_"+String(Object.keys(h.models).length)+"_"+t,h.addModel(t,e),a.modelName=t),a.modelName?h.activeModel=h.models[a.modelName]:h.activeModel=void 0===e?{}:e}for(d in h.activeParameterList)h.activeParameterList.hasOwnProperty(d)&&(h.activeModel[d]=h.activeParameterList[d]);R(null,c,function(e){var t,o=[],r=[],n=0,a=0;function l(){if(h.activeTemplate=e,void 0!==c.onRouteLoad&&h.activeController&&h.activeController.viewEngine!==g.Vue)try{c.onRouteLoad.apply(h.activeModel,h.activeParameters)}catch(e){h.showErrorAlert("Error from Controller [path="+c.path+"] on [onRouteLoad()]: "+e.toString()),console.error(e)}window.scrollTo(0,0),h.updateView(),m=!1}for(t in h.plugins)h.plugins.hasOwnProperty(t)&&void 0!==h.plugins[t].onRouteLoad&&(o.push(h.plugins[t].onRouteLoad),r.push(t));(0===(a=o.length)?l:function t(){try{var e=r[n],e=h.plugins[e];o[n].call(e,function(e){!1!==e?(++n===a?l:t)():m=!1})}catch(e){h.showErrorAlert("Error from Plugin ["+r[n]+"] on [onRouteLoad()]: "+e.toString()),console.error(e),h.updateView(),m=!1}})()})},void 0!==(n=c).settings&&void 0!==n.settings.lazyLoad?(null!==h.settings.lazyTemplateSelector&&(l=document.querySelector(h.settings.viewSelector),a=document.querySelector(h.settings.lazyTemplateSelector),l&&a&&("TEMPLATE"===a.tagName||"SCRIPT"===a.tagName&&"text"===a.getAttribute("data-engine")?l.innerHTML=a.innerHTML:console.warn("Unable to show loading screen from [app.settings.lazyTemplateSelector]. Only <template> tags are allowed."))),l=n.settings.lazyLoad.split(",").map(function(e){return e.trim()}),p=[],l.forEach(function(e){void 0===h.lazyLoad[e]?console.error("Missing [app.LazyLoad] scripts for: "+e):p.push(h.loadScripts(h.lazyLoad[e]))}),Promise.all(p).finally(function(){x(n),u()})):(x(n),u())}function x(e){if(null!==e.pageType&&void 0!==e.pageType&&void 0===e._pageCopied){var t=null;if(void 0===h.pages[e.pageType]?t="The page ["+e.pageType+"] has not been loaded for Controller[path="+e.path+"].":"object"==typeof h.pages[e.pageType]&&"object"!=typeof h.pages[e.pageType].model&&(t="Error - The [model] property for page object ["+e.pageType+"] must be a valid JavaScript Object."),null!==t)return e.settings=e.settings||{},e.settings.errorMessage=t,e.settings.hasError=!0,void h.showErrorAlert(t);var o=h.pages[e.pageType];if("function"==typeof o)for(var r=h.getClassFunctionNames(o),n=["onRouteLoad","onBeforeRender","onRendered","onRouteUnload"],a=0;a<r.length;a++){var l=r[a];n.includes(l)&&(e[l]=o.prototype[l])}else for(var i in o)o.hasOwnProperty(i)&&"function"==typeof o[i]&&(e[i]=o[i]);e.viewEngine===g.Vue&&"object"==typeof o.computed&&void 0===e.computed&&(e.computed=o.computed),e._pageCopied=!0}}function o(e){var t=new Date,t="toLocaleString"in t?t.toLocaleString():t.toString(),t=-1<e.message.toLowerCase().indexOf("script error")?"Script Error at "+t+": See Browser Console for Detail":["Message: ["+e.message+"]","Time: ["+t+"]","URL: ["+e.filename+"]","Line: "+e.lineno,"Column: "+e.colno,"Error Object: "+JSON.stringify(e.error)].join(" - ");h.showErrorAlert(t),console.error(e)}void 0===window.DataFormsJS&&(h={controllers:[],models:{},pages:{},plugins:{},controls:{},graphQL:{},lazyLoad:{},locals:{},settings:{defaultRoute:"/",viewSelector:"#view",logFetchRequests:!1,requestHeaders:{},requestHeadersByHostName:{},fetchOptions:{mode:"cors",cache:"no-store",credentials:"same-origin"},polyfillUrl:"https://polyfill.io/v3/polyfill.min.js?features=Array.from,Array.isArray,Array.prototype.find,Object.assign,URL,fetch,Promise,Promise.prototype.finally,String.prototype.endsWith,String.prototype.startsWith,String.prototype.includes,String.prototype.repeat",cssPonyfillUrl:"https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2.4.3/dist/css-vars-ponyfill.min.js",graphqlUrl:null,errors:{pageLoading:"Error loading the current page because the previous page is still loading and is taking a long time. Please refresh the page and try again."},lazyTemplateSelector:null,clearVue2WatchersOnRouteUnload:!1},activeController:null,activeTemplate:null,activeModel:null,activeVueModel:null,activeVueApp:null,vueDirectives:null,activeParameters:[],activeParameterList:{},activeJsControls:[],compiledTemplates:[],onUpdateViewComplete:null,nunjucksEnvironment:null,errorClass:"dataformsjs-error",fatalErrorClass:"dataformsjs-fatal-error",errorStyleId:"dataformsjs-style-errors",errorCss:[".dataformsjs-error,.dataformsjs-fatal-error{","color:#fff;","background-color:red;","box-shadow:0 1px 5px 0 rgba(0,0,0,.5);","background-image:linear-gradient(#e00,#c00);","/*white-space:pre;*/","text-align:left;","}",".dataformsjs-error{","padding:10px;","font-size:1em;","margin:5px;","display:inline-block;","}",".dataformsjs-fatal-error{","z-index:1000000;","padding:20px;","font-size:1.5em;","margin:20px;","position:fixed;","top:10px;","}","@media only screen and (min-width:1000px){",".dataformsjs-fatal-error{","max-width:1000px;","left:calc(50% - 520px);","}","}",".dataformsjs-fatal-error span{","padding:5px 10px;","float:right;","border:1px solid darkred;","cursor:pointer;","margin-left:10px;","box-shadow:0 0 2px 1px rgba(0,0,0,0.3);","background-image:linear-gradient(#c00,#a00);","border-radius:5px;","}"].join(""),vueStyleId:"dataformsjs-style-vue-cloak",vueCss:"[v-cloak] { display: none !important; }",escapeHtml:function(e){return null==e||"number"==typeof e?e:String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},fetch:function(t,e,o){var r=h.deepClone({},h.settings.fetchOptions);return r.headers=h.getRequestHeaders(t),e&&(Object.assign(r,e),void 0!==e.headers&&(r.headers=Object.assign({},h.getRequestHeaders(t),e.headers))),!n||void 0!==r.method&&"GET"!==r.method&&"HEAD"!==r.method||"no-store"!==r.cache&&"no-cache"!==r.cache||((e=/([?&])_=[^&]*/).test(t)?t=t.replace(e,"$1_="+(new Date).getTime()):t+=(/\?/.test(t)?"&":"?")+"_="+(new Date).getTime()),fetch(t,r).then(function(e){return h.settings.logFetchRequests&&h.events&&"function"==typeof h.events.dispatch&&h.events.dispatch("fetch",{url:t,status:e.status}),Promise.resolve(e)}).then(function(e){var t=e.status;return 200<=t&&t<300||304===t?Promise.resolve(e):(t="Error loading data. Server Response Code: "+t+", Response Text: "+e.statusText,Promise.reject(t))}).then(function(e){var t=void 0===o?"application/json":o;return 0===(t=e.headers.has("Content-Type")?e.headers.get("Content-Type"):t).indexOf("application/json")?e.json():e.text()})},routingMode:function(){return y},changeRoute:function(e){if("string"!=typeof e)throw new TypeError("Expected string for app.changeRoute(path)");"history"===y?(window.history.pushState(null,null,e),V()):window.location.hash=0===e.indexOf("#")?e:"#"+e},pushStateClick:function(e){if(!0!==e.ctrlKey&&!e.metaKey)return e.preventDefault(),e.stopPropagation(),e.currentTarget.href?h.changeRoute(e.currentTarget.href):console.error("app.pushStateClick() called for an unknown link"),!1},addPage:function(e,t){var o,r=["onRouteLoad","onBeforeRender","onRendered","onRouteUnload"],n=(l(e,"string","name","app.addPage()"),i(e,"name","app.addPage()"),!1);if("object"==typeof t)o=t,n=!0;else{if("function"!=typeof t||"class"!==t.toString().substring(0,5))throw new TypeError("Page ["+e+"] must be defined as an object or a class when the function app.addPage() is called");o=t.prototype}return T(o,e,"page",r),r.pop(),S(o,e,"page",r),n&&d(t.model,"page."+e+".model","app.addPage()"),f(this.pages,"app.pages",e),this.pages[e]=t,this},addPlugin:function(e,t){function o(){"function"==typeof this.onRouteUnload&&this.onRouteUnload(),this.onRendered()}if(l(e,"string","name","app.addPlugin()"),i(e,"name","app.addPlugin()"),f(this.plugins,"app.plugins",e),"function"==typeof(t="function"==typeof t&&"class"===t.toString().substring(0,5)?new t:t))return this.plugins[e]={onRendered:t,reload:o},this;var r=["onRouteLoad","onBeforeRender","onRendered","onRouteUnload"];return l(t,"object","plugin","app.addPlugin()"),T(t,e,"plugin",r),r.pop(),S(t,e,"plugin",r),void 0===t.reload&&(t.reload=o),this.plugins[e]=t,this},addControl:function(e,t){if(l(e,"string","name","app.addControl()"),i(e,"name","app.addControl()"),e!==e.toLowerCase())throw new TypeError("Control names must be all lower-case. [app.addControl()] was called with: ["+e+"]");if(-1===e.indexOf("-"))throw new TypeError("Control names must contain a dash [-] character. [app.addControl()] was called with: ["+e+"]");if(-1!==e.indexOf(" "))throw new TypeError("Control names cannot contain a space. [app.addControl()] was called with: ["+e+"]");if(!1!==/[&<>"'/]/.test(e))throw new TypeError("Control names cannot contain HTML characters that need to be escaped. Invalid characters are [& < > \" ' /]. [app.addControl()] was called with: ["+e+"]");l(t,"object","control","app.addControl()"),void 0!==t.css&&l(t.css,"string","control.css","app.addControl()");var o=["onLoad","html","onUnload"];return S(t,e,"control",o),T(t,e,"control",o),o.pop(),S(t,e,"control",o),f(this.controls,"app.controls",e),this.controls[e]=t,this},addModel:function(e,t){return l(e,"string","name","app.addModel()"),i(e,"name","app.addModel()"),l(t,"object","model","app.addModel()"),f(this.models,"app.models",e),this.models[e]=t,this},addController:function(t){var e,o=["onRouteLoad","onBeforeRender","onRendered","onRouteUnload"];if(l(t,"object","controller","app.addController()"),l(t.path,"string","controller.path","app.addController()"),i(t.path,"controller.path","app.addController()"),this.controllers.forEach(function(e){if(e.path===t.path)throw new TypeError("[app.controllers(path="+t.path+")] is already defined")}),e="app.addController(path="+t.path+")",void 0===t.viewId)t.viewId=null;else{l(t.viewId,"string","controller.viewId",e),i(t.viewId,"controller.viewId",e);var r=t.viewId,n="controller.viewId",a=e;if(null===document.getElementById(r))throw new TypeError("An element was not found on the page with ["+n+"][id="+r+"] when the function "+a+" was called")}if(void 0===t.viewUrl?t.viewUrl=null:(l(t.viewUrl,"string","controller.viewUrl",e),i(t.viewUrl,"controller.viewUrl",e)),null!==t.viewId&&null!==t.viewUrl)throw new TypeError("A controller cannot have both [viewId] and [viewUrl] defined when calling "+e);if(void 0!==t.viewEngine){if(null===t.viewId&&null===t.viewUrl)throw new TypeError("When a controller uses the [viewEngine] property either [viewId] or [viewUrl] must also be defined when calling "+e);if(-1===p.indexOf(t.viewEngine))throw new TypeError("Invalid [viewEngine] property when calling "+e+". Valid values are: "+p.join(", "))}return null!==t.modelName&&void 0!==t.modelName&&(l(t.modelName,"string","controller.modelName",e),i(t.modelName,"controller.modelName",e),d(this.models[t.modelName],"app.models."+t.modelName,e)),null!==t.pageType&&void 0!==t.pageType&&(l(t.pageType,"string","controller.pageType",e),i(t.pageType,"controller.pageType",e)),T(t,t.path,"controller",o),null!==t.pageType&&void 0!==t.pageType||(o.pop(),o.push("viewId"),o.push("viewUrl"),S(t,t.path,"controller",o)),this.controllers.push(t),this},controller:function(e){for(var t=0,o=this.controllers.length;t<o;t++)if(this.controllers[t].path===e)return this.controllers[t];return null},showError:function(e,t){var o;null!==e?(h.loadCss(h.errorStyleId,h.errorCss),o=r("span",t,h.errorClass),e.innerHTML="",e.appendChild(o),"string"!=typeof t&&console.error(t)):h.showErrorAlert(t)},showErrorAlert:function(e){h.loadCss(h.errorStyleId,h.errorCss);var t=r("div",e="string"==typeof e&&-1===e.toLowerCase().indexOf("error")?"Error: "+e:e,h.fatalErrorClass),o=r("span","âœ•");o.onclick=function(){document.body.removeChild(t)},t.insertBefore(o,t.firstChild),document.body.appendChild(t),"string"!=typeof e&&console.error(e)},isUsingVue:function(){return null!==h.activeVueModel||h.activeController&&"Vue"===h.activeController.viewEngine||"Vue"===h.viewEngine()},isUsingVue2:function(){return this.isUsingVue()&&void 0===Vue.createApp},isUsingVue3:function(){return this.isUsingVue()&&"function"==typeof Vue.createApp},isUpdatingView:function(){return v},updateView:function(){function e(){var e,t,o,r,n;if(v=!0,null!==h.activeVueModel&&null===h.activeVueApp)return e=0,(t=h.activeVueModel._watcher)&&t.deps&&t.deps.length&&(e=t.deps.length),b!==e&&a("vue_dep_change"),v=!(w=!0),void(b=e);if(null===h.activeVueApp){h.unloadAllJsControls();try{if(!(h.activeController&&h.activeController.viewEngine===g.Vue)&&h.activeController&&void 0!==h.activeController.onBeforeRender)try{h.activeController.onBeforeRender.apply(h.activeModel,h.activeParameters)}catch(e){h.showErrorAlert("Error from Controller [path="+h.activeController.path+"] on [onBeforeRender()]: "+e.toString()),console.error(e)}for(o in h.plugins)if(h.plugins.hasOwnProperty(o)&&void 0!==h.plugins[o].onBeforeRender)try{h.plugins[o].onBeforeRender()}catch(e){h.showErrorAlert("Error from Plugin ["+o+"] on [onBeforeRender()]: "+e.toString()),console.error(e)}null!==h.activeTemplate&&(null===(r=document.querySelector(h.settings.viewSelector))?(n="Error - The main HTML element for rendering views from selector ["+h.settings.viewSelector+"] does not exist on this page. Check HTML on the page to makes sure that the element exist; and if it does then check to make sure that JavaScript Code did not remove it from the page",h.showErrorAlert(n)):(h.activeController&&h.activeController.viewEngine===g.Vue&&r.setAttribute("v-cloak",""),U(r,h.activeController,h.activeTemplate,h.activeModel))),h.refreshAllHtmlControls(function(){var t,e,o,r;h.activeController&&h.activeController.viewEngine===g.Vue?(t=document.querySelector(h.settings.viewSelector),e=function(e){console.error("Vue Error"),L(e,t)},o=function(e){console.error("Vue Warning"),L(e,t)},r="function"==typeof Vue.createApp,h.activeTemplate&&h.activeTemplate.error?(h.showError(document.querySelector(h.settings.viewSelector),h.activeTemplate.errorMessage),a("updateView")):r?(h.activeVueApp=Vue.createApp({data:function(){return h.activeModel},directives:h.vueDirectives,methods:h.activeController.methods,computed:h.activeController.computed,mounted:function(){h.activeVueModel=this,h.activeVueModel.$nextTick(function(){if(void 0!==h.activeController.onRouteLoad)try{h.activeController.onRouteLoad.apply(h.activeVueModel,h.activeParameters)}catch(e){h.showErrorAlert("Error from Controller [path="+h.activeController.path+"] on [onRouteLoad()]: "+e.toString()),console.error(e)}h.loadAllJsControls(),a("vue_mounted",h.activeVueModel)})},updated:function(){this.$nextTick(function(){w&&(h.loadAllJsControls(),a("vue_updated"),w=!1)})},beforeUnmount:function(){try{void 0!==h.activeController.onRouteUnload&&h.activeController.onRouteUnload.apply(h.activeVueModel,h.activeParameters)}catch(e){h.showErrorAlert("Error from Controller [path="+h.activeController.path+"] on [onRouteUnload()]: "+e.toString()),console.error(e)}}}),h.activeVueApp.errorHandler=e,h.activeVueApp.warnHandler=o,h.activeVueApp.mount(h.settings.viewSelector)):(Vue.config.errorHandler=e,Vue.config.warnHandler=o,h.activeVueModel=new Vue({el:h.settings.viewSelector,data:h.activeModel,methods:h.activeController.methods,computed:h.activeController.computed,mounted:function(){var e=this;e.$nextTick(function(){if(void 0!==h.activeController.onRouteLoad)try{h.activeController.onRouteLoad.apply(e,h.activeParameters)}catch(e){h.showErrorAlert("Error from Controller [path="+h.activeController.path+"] on [onRouteLoad()]: "+e.toString()),console.error(e)}h.loadAllJsControls(),a("vue_mounted",e)})},updated:function(){this.$nextTick(function(){var e;w&&(h.loadAllJsControls(),a("vue_updated"),(e=this._watcher)&&e.deps&&e.deps.length&&(b=this._watcher.deps.length),w=!1)})},beforeDestroy:function(){try{void 0!==h.activeController.onRouteUnload&&h.activeController.onRouteUnload.apply(this,h.activeParameters)}catch(e){h.showErrorAlert("Error from Controller [path="+h.activeController.path+"] on [onRouteUnload()]: "+e.toString()),console.error(e)}}}))):(h.loadAllJsControls(),a("updateView")),v=!1})}catch(e){throw v=!1,console.error(e),e}}else v=!(w=!0)}function a(e,t){for(var o in"history"===y&&(r=document.querySelectorAll('a[href^="/"]:not([data-no-pushstate])'),Array.prototype.forEach.call(r,function(e){e.addEventListener("click",h.pushStateClick)})),h.plugins)if(h.plugins.hasOwnProperty(o)&&void 0!==h.plugins[o].onRendered)try{h.plugins[o].onRendered()}catch(e){h.showErrorAlert("Error from Plugin ["+o+"] on [onRendered()]: "+e.toString()),console.error(e)}var r=h.activeController&&h.activeController.viewEngine===g.Vue,n=h.activeController&&h.activeController.onRendered;if("function"==typeof n){t=r?t||h.activeVueModel:t||h.activeModel;try{n.apply(t,h.activeParameters)}catch(e){h.showErrorAlert("Error from Controller [path="+h.activeController.path+"] on [onRendered()]: "+e.toString()),console.error(e)}}if(null!==h.onUpdateViewComplete)try{h.onUpdateViewComplete(e)}catch(e){h.showErrorAlert("Error from [app.onUpdateViewComplete()]: "+e.toString()),console.error(e)}}v?t=window.setInterval(function(){v||(window.clearInterval(t),t=null,e())},10):e()},refreshAllHtmlControls:function(e,r){var n=String((new Date).getTime()),a='[data-template-id]:not([data-updated-at="'+n+'"])';a+=',[data-template-url]:not([data-updated-at="'+n+'"])',s=!0,function t(o){if(null===o)s=!1,v||h.refreshPlugins(),e&&e(n);else try{h.refreshHtmlControl(o,function(){o.setAttribute("data-updated-at",n),t(document.querySelector(a))},r)}catch(e){o.setAttribute("data-updated-at",n),t(document.querySelector(a))}}(document.querySelector(a))},refreshHtmlControl:function(t,o,r){try{var e="string"==typeof t,n=t instanceof HTMLElement;if(!e&&!n)throw new TypeError("Invalid type for parameter [control] in the function [DataFormsJS.refreshHtmlControl()]: "+typeof t);if(e){var a=t;if(null===(t=document.getElementById(a)))throw new TypeError("Control not found for ["+a+"] when the function [DataFormsJS.refreshHtmlControl()] was called.")}if(void 0!==o&&"function"!=typeof o)throw new TypeError("[callback] was not defined as a [function] when the [DataFormsJS.refreshHtmlControl()] was called");var l=t.getAttribute("data-template-id"),i=t.getAttribute("data-template-url");if(null!==l&&null!==i)throw new TypeError("A control must have only one of the template attribute defined; either [data-template-id] or [data-template-url]. Both attributes are defined on the control.");if(null===l&&null===i)throw new TypeError("A control must have either attribute [data-template-id] or [data-template-url]. Niether attribute is defined for the control.");void 0===r&&(r=this.activeModel),R(t,null,function(e){U(t,null,e,r),v||(h.loadAllJsControls(t,r),h.unloadUnattachedJsControls()),s||h.refreshPlugins(t),void 0!==o&&o()})}catch(e){throw console.error(e),null!==t&&t instanceof HTMLElement&&h.showError(t,A(t,null)+e.message),e}},refreshPlugins:function(e){function t(){for(var t in h.plugins)if(h.plugins.hasOwnProperty(t)&&void 0!==h.plugins[t].onRendered)try{void 0===e?h.plugins[t].onRendered():1===h.plugins[t].onRendered.length&&h.plugins[t].onRendered(e)}catch(e){h.showErrorAlert("Error from Plugin ["+t+"] on [onRendered()]: "+e.toString()),console.error(e)}}h.activeController&&h.activeController.viewEngine===g.Vue&&h.activeVueModel&&"function"==typeof h.activeVueModel.$nextTick?h.activeVueModel.$nextTick(t):t()},loadAllJsControls:function(o,r){var t=["[data-control]:not([data-control-loaded]):not([data-control-is-loading])"],n=(Object.keys(h.controls).forEach(function(e){-1!==e.indexOf("-")&&-1===e.indexOf(" ")&&t.push(e+":not([data-control-loaded]):not([data-control-is-loading])")}),t.join(","));void 0===o&&(o=document),void 0===r&&(r=h.activeModel),function e(t){if(null!==t){try{h.loadJsControl(t,r)}catch(e){t.setAttribute("data-control-loaded",""),h.showError(t,e.toString()),console.error(e)}e(o.querySelector(n))}}(o.querySelector(n))},loadJsControl:function(t,e){var o,r,n,a,l,i;if(t instanceof HTMLElement)t.hasAttribute("data-control-loaded")&&(l=h.activeJsControls.find(function(e){return e.element===t}));else{if(void 0===(l="object"==typeof t?h.activeJsControls.find(function(e){return e===t}):l))throw new TypeError("Invalid type for parameter [element] for the function [DataFormsJS.loadJsControl()], expected HTMLElement, received: "+typeof t);t=l.element}if(null===(o=t.getAttribute("data-control"))&&(o=t.tagName.toLowerCase()),void 0===(r=h.controls[o]))throw-1===o.indexOf("-")?(h.showError(t,i="Invalid call to [DataFormsJS.loadJsControl()]. This function only works on valid control elements."),console.log(t),new TypeError(i)):new Error("JavaScript Control was not found by name, check that the file is loaded: "+o);for(a in t.setAttribute("data-control",o),n=void 0===r.data?{}:h.deepClone({},r.data),t.dataset)if("control"!==a){var s=t.dataset[a];switch(s){case"true":case"":n[a]=!0;break;case"false":n[a]=!1;break;case"null":n[a]=null;break;default:n[a]=s}}if(void 0!==r.css&&h.loadCss("DataFormsJS-control-style-"+o,r.css),void 0===e&&(e=h.activeModel),null===t.getAttribute("data-control-is-loading")){t.setAttribute("data-control-is-loading",""),i=!1;try{void 0!==r.onLoad&&r.onLoad.call(n,t,e)}catch(e){h.showError(t,"Error with JavaScript Control ["+o+"] in function [onLoad()]: "+e.toString()),console.error(e),i=!0}if(!i)try{void 0!==r.html&&(t.innerHTML=r.html.call(n,e))}catch(e){h.showError(t,"Error with JavaScript Control ["+o+"] in function [html()]: "+e.toString()),console.error(e)}t.setAttribute("data-control-loaded",""),t.removeAttribute("data-control-is-loading"),void 0===l?h.activeJsControls.push({element:t,control:o,data:n}):l.data=n}},unloadAllJsControls:function(){h.activeJsControls.forEach(function(e){h.unloadJsControl(e)}),h.activeJsControls=[]},unloadUnattachedJsControls:function(){for(var e,t=h.activeJsControls.length;0<t;t--)document.body.contains(h.activeJsControls[t-1].element)||(e=h.activeJsControls.splice(t-1,1),h.unloadJsControl(e[0]))},unloadJsControl:function(t){var o=h.controls[t.control];if(void 0!==o.onUnload)try{o.onUnload.call(t.data,t.element)}catch(e){o="Unknown Control";t.element&&(o=(o=t.element.getAttribute("data-control"))||"Unknown Control"),h.showErrorAlert("Error with JavaScript Control ["+o+"] in function [onUnload()]: "+e.toString()),console.error(e)}t.element.removeAttribute("data-control-loaded")},routeMatches:function(e,t){var o,r,n=e.split("/"),a=t.split("/"),l=n.length,i=[],s={};if(l!==a.length)return{isMatch:!1};for(o=0;o<l;o++)if((r=decodeURIComponent(n[o]))!==a[o]){if(":"!==a[o].substring(0,1))return{isMatch:!1};i.push(r),s[a[o].substring(1)]=r}return{isMatch:!0,args:i,namedArgs:s}},getClassFunctionNames:function(e){for(var t=[],o=e;o&&o.prototype&&o!==Object;){for(var r=Object.getOwnPropertyNames(o.prototype),n=0;n<r.length;n++){var a=r[n];"function"!=typeof o.prototype[a]||t.includes(a)||t.push(a)}o=Object.getPrototypeOf(o)}return t},deepClone:function(){var e,t,o,r,n,a=arguments.length;if(0===a)throw new TypeError("No arguments specified when app.deepClone() was called.");if(1===a)throw new TypeError("Only one argument was specified when app.deepClone() was called.");for(e=0;e<a;e++)l(arguments[e],"object","argument","app.deepClone()");for(t=arguments[0],e=1;e<a;e++)for(r in o=arguments[e])o.hasOwnProperty(r)&&(void 0!==(n=Object.getOwnPropertyDescriptor(o,r)).get||void 0!==n.set?Object.defineProperty(t,r,n):(n=Object.prototype.toString.call(o[r]),t[r]="[object Object]"===n?this.deepClone({},o[r]):"[object Array]"===n?this.deepClone([],o[r]):o[r]));return t},getTemplateType:function(e){if(void 0===e)throw new TypeError("Missing parameter [script] for the function [DataFormsJS.getTemplateType()]");if(!(e instanceof HTMLElement))throw new TypeError("Invalid type for parameter [script] for the function [DataFormsJS.getTemplateType()], expected HTMLElement, received: "+typeof e);if("TEMPLATE"!==e.tagName&&"SCRIPT"!==e.tagName)throw new TypeError("Invalid type for parameter [script] for the function [DataFormsJS.getTemplateType()], expected <script> or <template>, received: "+e.tagName.toLowerCase());if("TEMPLATE"===e.tagName)return g.Text;switch(e.getAttribute("data-engine")){case"handlebars":return g.Handlebars;case"vue":return g.Vue;case"nunjucks":return g.Nunjucks;case"underscore":return g.Underscore;case"text":return g.Text;default:return g.Unknown}},viewEngine:function(e){if(void 0===e)return c;switch(e){case g.NotSet:case g.Unknown:case g.Mixed:throw new TypeError("Invalid value specified for setting the ViewEngine: "+e);default:if(void 0===g[e])throw new TypeError("Unknown value specified for setting the ViewEngine ["+e+"], refer to documentation or values from the enum/object [ViewEngines] for valid options.")}return c=e,this},loadCss:function(e,t){var o=document.getElementById(e);null===o&&((o=document.createElement("style")).id=e,o.innerHTML=t,document.head.appendChild(o))},loadScript:function(e,r,t){function o(e,t){var o=document.createElement("script");o.onload=e,o.onerror=function(){console.error("Error loading Script: "+r),t()},o.src=r,document.head.appendChild(o)}if(!1===e||void 0===e){if(void 0===t)return new Promise(function(e,t){o(e,t)});o(t,t)}else{if(void 0===t)return new Promise(function(e){e()});t()}},loadScripts:function(i){if("string"==typeof i)i=[i];else if(!Array.isArray(i))return h.showErrorAlert("Invalid Script for [app.loadScripts()] or [app.lazyLoad], expected string or an array of strings. Check console."),console.warn("app.loadScripts():"),console.warn(i),new Promise(function(e){e()});return new Promise(function(o){var r=0,n=i.length;!function e(){var t,a,l;r!==n?(t=i[r],r++,t.endsWith(".js")?(l=t,new Promise(function(e){for(var t=document.querySelectorAll("script"),o=0,r=t.length;o<r;o++)if(t[o].getAttribute("src")===l)return void e();var n=document.createElement("script");n.onload=e,n.onerror=function(){h.showErrorAlert("Error loading JS File: "+l),e()},n.src=l,document.head.appendChild(n)}).then(e)):t.endsWith(".css")?(a=t,new Promise(function(e){for(var t=document.querySelectorAll("link"),o=0,r=t.length;o<r;o++)if("stylesheet"===t[o].rel&&t[o].getAttribute("href")===a)return void e();var n=document.createElement("link");n.rel="stylesheet",n.onload=e,n.onerror=function(){h.showErrorAlert("Error loading CSS File: "+a),e()},n.href=a,document.head.appendChild(n)}).then(e)):(h.showErrorAlert("Invalid Script for [app.loadScripts()] or [app.lazyLoad]: "+t),e())):o()}()})},buildUrl:function(e,t){if(void 0===t&&(t=h.activeParameterList),e=String(e).replace(/\{(\w+)\}/g,function(e,t){return"string"==typeof window[t]?window[t]:e}),null!==t&&0<Object.keys(t).length)for(var o in t)t.hasOwnProperty(o)&&-1<e.indexOf(":"+o)&&(e=e.replace(new RegExp(":"+o,"g"),encodeURIComponent(t[o])));return e},getGraphQL:function(r,o){var n,a;return r&&o?new Promise(function(e,t){t('Error calling [app.getGraphQL()]. Both [id="'+r+'"] and [src="'+o+'"] are set. Only one value can be used.')}):(n=r||o)&&void 0!==h.graphQL[n]?new Promise(function(e,t){h.graphQL[n].query?e(h.graphQL[n].query):t(h.graphQL[n].error)}):r?new Promise(function(e,t){var o=null;null===(a=document.getElementById(r))?o="Missing GraphQL Script Element: "+r:"SCRIPT"!==a.nodeName||"application/graphql"!==a.type?o='Invalid Element for GraphQL Script, expected: <script type="application/graphql" id="'+r+'">':(h.graphQL[r]={query:a.innerHTML,error:null},e(a.innerHTML)),null!==o&&(h.graphQL[r]={query:null,error:o},t(o))}):o?h.fetch(o,null,"text/plain").then(function(e){return h.graphQL[o]={query:e,error:null},e}).catch(function(e){e="Error Downloading GraphQL Script: ["+o+"], Error: "+e;throw h.graphQL[o]={query:null,error:e},e}):new Promise(function(e,t){t("Error calling [app.getGraphQL()]. Missing GraphQL Parameters.")})},buildGraphQLVariables:function(e,t){var o,r,n={};if(0<Object.keys(t).length)for(var a in t)t.hasOwnProperty(a)&&-1<e.indexOf("$"+a)&&(o=-1!==e.indexOf("($"+a+": Int"),r=t[a],n[a]=o?Number(r):r);return n},handleGlobalErrors:function(e){e?window.addEventListener("error",o):window.removeEventListener("error",o)},getRequestHeaders:function(e){var t,o={},r=h.settings.requestHeaders;for(t in r)r.hasOwnProperty(t)&&(o[t]=r[t]);if(0<Object.keys(h.settings.requestHeadersByHostName).length&&(e=new URL(e,window.location).hostname,void 0!==(r=h.settings.requestHeadersByHostName[e])))for(t in r)r.hasOwnProperty(t)&&(o[t]=r[t]);return o},updateTemplatesForIE:function(e){n&&(e=e.querySelectorAll("template"),Array.prototype.forEach.call(e,function(e){for(var t=document.createElement("script"),o=0,r=e.attributes.length;o<r;o++)t.setAttribute(e.attributes[o].name,e.attributes[o].value);t.type="text/x-template",t.setAttribute("data-engine","text"),t.innerHTML=e.innerHTML,e.parentNode.replaceChild(t,e)}))},cssVarsPonyfill:function(){var e,t='link[rel="stylesheet"][data-css-vars-ponyfill],style[data-css-vars-ponyfill]';null!==document.querySelector(t)&&(e=window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),h.loadScript(e,h.settings.cssPonyfillUrl,function(){window.cssVars&&window.cssVars({include:t})}))},setup:function(){c=g.Unknown;var e,t=0,o=[{prop:"Handlebars",type:"handlebars",label:g.Handlebars},{prop:"Vue",type:"vue",label:g.Vue},{prop:"nunjucks",type:"nunjucks",label:g.Nunjucks},{prop:"_",type:"underscore",label:g.Underscore}];for(e in o)null!==document.querySelector('script[type="text/x-template"][data-engine="'+o[e].type+'"]')&&(c=o[e].label,t++);if(0===t)for(e in o)window[o[e].prop]&&(c=o[e].label,t++);1<t&&(c=g.Mixed),void 0!==window.Vue&&h.loadCss(h.vueStyleId,h.vueCss),null!==document.documentElement.getAttribute("data-show-errors")&&h.handleGlobalErrors(!0),h.settings.graphqlUrl=document.documentElement.getAttribute("data-graphql-url"),null===y&&"history"!==(y=document.documentElement.getAttribute("data-routing-mode"))&&(y="hash"),h.updateTemplatesForIE(document);var r=document.querySelectorAll('script[type="text/x-template"][data-route],template[data-route]');Array.prototype.forEach.call(r,function(e){var t=e.getAttribute("data-route"),o=e.id,r=e.src||e.getAttribute("data-src"),n=e.getAttribute("data-page"),c=e.getAttribute("data-model"),u=e.getAttribute("data-controller-added"),a=h.getTemplateType(e),p=e.getAttribute("data-default-route"),l=0,i={};if(null===u){if(""===t)return console.log(e),void h.showErrorAlert(new TypeError('A script element <script id="'+e.id+'" type="'+e.type+'" data-engine="'+e.getAttribute("data-engine")+'"> has the attribute [data-route] defined however the attribute value is empty. This error must be fixed, scripts that include a route path attribute must have the value defined.'));if(a===g.Unknown)return console.log(e),void h.showErrorAlert(new TypeError('A script element <script id="'+e.id+'" type="'+e.type+'" data-engine="'+e.getAttribute("data-engine")+'" data-route="'+e.getAttribute("data-route")+'"> must have a valid engine type defined in [data-engine]. Valid values are [handlebars, vue, underscore, nunjucks, text].'));if(""===o&&(""===r||null===r))for(;o="template"+l,null===document.querySelector("#"+o)&&(e.id=o),l++,""===e.id;);""===r||null===r?r=void 0:o=void 0;var s,f=["route","page","model","src","engine"];for(s in e.dataset)if(-1===f.indexOf(s)){var d=e.dataset[s];switch(d){case"true":case"":i[s]=!0;break;case"false":i[s]=!1;break;case"null":i[s]=null;break;default:i[s]=d}}try{h.addController({path:t,viewId:o,viewUrl:r,viewEngine:a,pageType:n,modelName:c,settings:i}),null!==p&&(h.settings.defaultRoute=t)}catch(e){h.showErrorAlert("Error from [app.setup()]: "+e),console.error(e)}e.setAttribute("data-controller-added","true")}}),"hash"===y?window.addEventListener("hashchange",V):window.addEventListener("popstate",V),V(),a||(h.cssVarsPonyfill(),a=!0)}},Object.defineProperty(h,"version",{value:"5.11.0",enumerable:!0}),window.DataFormsJS=h,void 0===window.app?window.app=h:h.showErrorAlert("Warning - [window.app] is already defined, pages, plugins, etc. may not load correctly."),document.addEventListener("DOMContentLoaded",function(){var e=!!(Array.from&&window.Promise&&window.fetch&&Promise.prototype.finally);h.loadScript(e,h.settings.polyfillUrl,h.setup)}))}();